(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-eac9e554"],{"11a4":function(e,t,a){},"16a5":function(e,t,a){},"1c2c":function(e,t,a){},4352:function(e,t,a){"use strict";a("16a5")},"4de4":function(e,t,a){"use strict";var r=a("23e7"),n=a("b727").filter,i=a("1dde"),s=a("ae40"),o=i("filter"),l=s("filter");r({target:"Array",proto:!0,forced:!o||!l},{filter:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},"7db0":function(e,t,a){"use strict";var r=a("23e7"),n=a("b727").find,i=a("44d2"),s=a("ae40"),o="find",l=!0,c=s(o);o in[]&&Array(1)[o]((function(){l=!1})),r({target:"Array",proto:!0,forced:l||!c},{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),i(o)},"88c6":function(e,t,a){"use strict";a("11a4")},"8c7f":function(e,t,a){"use strict";a("9b7e")},"9b7e":function(e,t,a){},b02a:function(e,t,a){"use strict";a("1c2c")},e382:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-container"},[a("el-card",{staticClass:"box-card search"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"人员搜索："}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formInline,callback:function(t){e.formInline=t},expression:"formInline"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.onSubmit}},[e._v("查询 ")])],1)],1)],1),a("el-card",{staticClass:"box-card"},[a("el-button",{staticClass:"established-button",attrs:{icon:"el-icon-circle-plus-outline"},on:{click:e.addDialog}},[e._v("新建")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"80"}}),a("el-table-column",{attrs:{prop:"userName",label:"人员名称",width:"225"}}),a("el-table-column",{attrs:{prop:"regionName",label:"归属区域",width:"225"}}),a("el-table-column",{attrs:{prop:"role.roleName",label:"角色",width:"225"}}),a("el-table-column",{attrs:{prop:"mobile",label:"联系电话",width:"225"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleClick(t.row)}}},[e._v(" 修改 ")]),a("el-button",{staticClass:"del",attrs:{type:"text",size:"small"},on:{click:function(a){return e.del(t.row)}}},[e._v("删除")])]}}])})],1),e.regionData.totalCount?a("pagenation",{attrs:{listIsShow:this.lastDisabled&&this.rightDisabled,taskList:e.regionData,lastDisabled:e.lastDisabled,rightDisabled:e.rightDisabled},on:{lastPage:e.getLastTaskService,nextPage:e.getNextTaskService}}):e._e()],1),a("AddPeople",{ref:"addPeople",attrs:{visible:e.dialogVisible,finishedAdd:e.getPeopleList,currentId:e.currentId},on:{"update:visible":function(t){e.dialogVisible=t}}})],1)},n=[],i=a("c7eb"),s=a("1da1"),o=(a("4de4"),a("d3b7"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.listIsShow?e._e():a("div",{staticClass:"total"},[a("span",[e._v("共"+e._s(e.taskList.totalCount)+"条数据 第"+e._s(e.taskList.pageIndex)+"/ "+e._s(Math.ceil(e.taskList.totalCount/10))+"页")]),a("div",{staticClass:"page-button"},[a("MyButton",{attrs:{btnStyle:e.pageBtnStyle,disabled:e.lastDisabled},on:{click:e.lastPage}},[e._v("上一页 ")]),a("MyButton",{attrs:{btnStyle:e.pageBtnStyle,disabled:e.rightDisabled},on:{click:e.nextPage}},[e._v("下一页 ")])],1)])}),l=[],c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mybutton"},[a("el-button",{class:{disabled:e.disabled},style:e.btnStyle,attrs:{disabled:e.disabled,type:"primary",icon:e.icon},on:{click:e.clickFn}},[e._t("lastIcon"),e._t("default")],2)],1)},u=[],d={name:"MyButton",data:function(){return{}},props:{icon:{type:String},btnStyle:{type:Object},disabled:{type:Boolean,default:!1}},created:function(){},methods:{clickFn:function(){this.$emit("click")}},computed:{}},m=d,p=(a("88c6"),a("2877")),f=Object(p["a"])(m,c,u,!1,null,"1d398e24",null),b=f.exports,h={name:"FooterPage",data:function(){return{pageBtnStyle:{background:"#d5ddf8",width:"70px",height:"32px",color:"#000",fontWeight:"400",marginLeft:"25px"}}},props:{listIsShow:{type:Boolean},taskList:{type:Object},lastDisabled:{type:Boolean},rightDisabled:{type:Boolean}},created:function(){},methods:{lastPage:function(){this.$emit("lastPage")},nextPage:function(){this.$emit("nextPage")}},computed:{},components:{MyButton:b}},g=h,v=(a("8c7f"),Object(p["a"])(g,o,l,!1,null,"7b00ee90",null)),w=v.exports,x=a("b775");function k(e){return Object(x["a"])({url:"/api/user-service/user/search",method:"GET",params:e})}function D(){return Object(x["a"])({url:"/api/user-service/role",method:"GET"})}function y(e){return Object(x["a"])({url:"/api/vm-service/region/search",method:"GET",params:e})}function j(e){return Object(x["a"])({url:"/api/vm-service/sku/fileUpload",method:"POST",data:e,headers:{"Content-Type":"multipart/form-data"}})}function O(e){return Object(x["a"])({url:"/api/user-service/user",method:"POST",data:e})}function I(e){return Object(x["a"])({url:"/api/user-service/user/"+e,method:"DELETE"})}var _=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"新增人员",visible:e.visible,width:"50%"},on:{close:e.outsideClose}},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"人员名称：",prop:"userName"}},[a("el-input",{attrs:{placeholder:"请选择",maxlength:"5","show-word-limit":""},model:{value:e.formData.userName,callback:function(t){e.$set(e.formData,"userName",t)},expression:"formData.userName"}})],1),a("el-form-item",{attrs:{label:"角色：",prop:"roleId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.roleName,callback:function(t){e.roleName=t},expression:"roleName"}},e._l(e.roleList,(function(e){return a("el-option",{key:e.roleId,attrs:{value:e.roleName,label:e.roleName}})})),1)],1),a("el-form-item",{attrs:{label:"联系电话：",prop:"mobile"}},[a("el-input",{attrs:{placeholder:"请选择",maxlength:"11","show-word-limit":""},model:{value:e.formData.mobile,callback:function(t){e.$set(e.formData,"mobile",t)},expression:"formData.mobile"}})],1),a("el-form-item",{attrs:{label:"负责区域：",prop:"regionName"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formData.regionName,callback:function(t){e.$set(e.formData,"regionName",t)},expression:"formData.regionName"}},e._l(e.areaList,(function(e){return a("el-option",{key:e.id,attrs:{value:e.name,label:e.name}})})),1)],1),a("el-form-item",{attrs:{label:"头像：",prop:"image"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传jpeg文件，且不超过2MB ")]),e.formData.image?a("img",{staticClass:"avatar",attrs:{src:e.formData.image}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"状态："}},[a("el-checkbox",{attrs:{label:"是否启用"},model:{value:e.formData.status,callback:function(t){e.$set(e.formData,"status",t)},expression:"formData.status"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{name:"type"},on:{click:e.outsideClose}},[e._v("取 消")]),a("el-button",{staticClass:"established-button",attrs:{type:"primary"},on:{click:e.commit}},[e._v(" 确 定 ")])],1)],1)},P=[],N=(a("7db0"),a("b0c0"),{name:"add",data:function(){return{checked:!0,formData:{userName:"",roleId:"",mobile:"",regionId:"",regionName:"",status:!1,image:""},formRules:{userName:[{required:!0,message:"请输入",trigger:"blur"}],roleId:[{required:!0,message:"请输入",trigger:"change"}],mobile:[{required:!0,message:"请输入",trigger:"blur"},{pattern:/^(?:(?:\+|00)86)?1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],regionName:[{required:!0,message:"请输入",trigger:"change"}],image:[{required:!0,message:"请上传",trigger:"blur"}]},roleList:[],areaList:[],roleName:""}},props:{visible:{type:Boolean,required:!0}},watch:{roleName:function(e,t){"运营员"===e?this.formData.roleId=2:"维修员"===e&&(this.formData.roleId=3)}},computed:{regionId:function(){var e,t=this,a={};return a=this.areaList.find((function(e){return e.name===t.formData.regionName})),null===(e=a)||void 0===e?void 0:e.id}},methods:{handleAvatarSuccess:function(e,t){var a=this;return Object(s["a"])(Object(i["a"])().mark((function e(){var r,n,s;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=new FormData,r.append("fileName",t.raw),e.next=4,j(r);case 4:n=e.sent,s=n.data,a.formData.image=s;case 7:case"end":return e.stop()}}),e)})))()},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},getPeopleRoleList:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,D();case 2:a=t.sent,e.roleList=a.data;case 4:case"end":return t.stop()}}),t)})))()},getAreaList:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var a,r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,y({pageSize:50});case 2:a=t.sent,r=a.data,e.areaList=r.currentPageRecords;case 5:case"end":return t.stop()}}),t)})))()},outsideClose:function(){this.$emit("update:visible",!1)},commit:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.formData.regionId=e.regionId,t.next=3,e.$refs.form.validate();case 3:return t.prev=3,t.next=6,O(e.formData);case 6:e.$message.success("添加人员成功"),e.outsideClose(),e.$emit("finishedAdd"),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](3),e.$message.error("添加人员失败");case 14:case"end":return t.stop()}}),t,null,[[3,11]])})))()},getPeopleById:function(){return Object(s["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},created:function(){this.getPeopleRoleList(),this.getAreaList()}}),S=N,C=(a("b02a"),Object(p["a"])(S,_,P,!1,null,"6b982155",null)),L=C.exports,$={data:function(){return{formInline:"",tableData:[],dialogVisible:!1,currentId:"",regionData:{},params:{pageIndex:1,pageSize:10}}},components:{AddPeople:L,pagenation:w},computed:{lastDisabled:function(){return this.regionData.pageIndex<=1},rightDisabled:function(){return this.regionData.pageIndex==Math.ceil(this.regionData.totalCount/10)}},created:function(){this.getPeopleList()},methods:{indexMethod:function(e){return e+1},addDialog:function(){this.dialogVisible=!0},onSubmit:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,k();case 2:a=t.sent,console.log(a),e.tableData=a.data.currentPageRecords.filter((function(t){return t.userName===e.formInline})),console.log(e.tableData);case 6:case"end":return t.stop()}}),t)})))()},handleClick:function(e){this.dialogVisible=!0,this.$refs.addPeople.getPeopleById(),this.currentId=e.id},del:function(e){var t=this;return Object(s["a"])(Object(i["a"])().mark((function a(){return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$confirm("此操作将删除该人员, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 3:return a.next=5,I(e.id);case 5:t.$message.success("删除该人员成功"),t.getPeopleList(),a.next=11;break;case 9:a.prev=9,a.t0=a["catch"](0);case 11:case"end":return a.stop()}}),a,null,[[0,9]])})))()},getPeopleList:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,k(e.params);case 2:a=t.sent,console.log(a),e.tableData=a.data.currentPageRecords,e.regionData=a.data;case 6:case"end":return t.stop()}}),t)})))()},getNextTaskService:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.params.pageIndex++,e.getPeopleList();case 2:case"end":return t.stop()}}),t)})))()},getLastTaskService:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.params.pageIndex--,e.getPeopleList();case 2:case"end":return t.stop()}}),t)})))()}}},B=$,A=(a("4352"),Object(p["a"])(B,r,n,!1,null,"2f23b13a",null));t["default"]=A.exports}}]);